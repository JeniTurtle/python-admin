{% extends 'common/layout.html' %}

{% block title %}白名单录入{% endblock %}

{% block content %}
<style>
    .m-t-8 {margin-top: 8px;}
    .form-group {overflow: hidden}
</style>
<div class="wrapper wrapper-content" id="view">

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>录入白名单【个人】</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <br>
                        <div class="col-sm-5 m-b-xs">
                            <div data-toggle="buttons" class="btn-group">
                                <label class="btn btn-sm btn-white check-type active" id="author-register-btn">
                                    <input type="radio" name="options">注册写作者</label>
                                <label class="btn btn-sm btn-white check-type" id="movieman-register-btn">
                                    <input type="radio" name="options">注册影视人</label>
                            </div>
                        </div>
                        <div class="col-sm-4" style="text-align: right;line-height: 32px">

                        </div>
                        <div class="col-sm-3">

                        </div>
                    </div>
                    <div class="hr-line-dashed"></div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label m-t-8">常用名</label>

                        <div class="col-sm-6">
                            <input type="text" value="{{ data.username or '' }}" name="username" placeholder="请输入常用名" class="form-control">
                        </div>
                        <div class="col-sm-4">
                            <span class="help-block m-b-none m-t-8"></span>
                        </div>
                    </div>
                    <div class="hr-line-dashed"></div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label m-t-8">电话号码</label>

                        <div class="col-sm-6">
                            <input type="text" value="{{ data.mobilePhoneNumber or '' }}" name="mobilePhoneNumber" placeholder="请输入电话号码" class="form-control">
                        </div>
                        <div class="col-sm-4">
                            <span class="help-block m-b-none m-t-8"></span>
                        </div>
                    </div>
                    <div class="hr-line-dashed"></div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label m-t-8">个人介绍</label>

                        <div class="col-sm-6">
                            <input type="text" value="{{ data.desc or '' }}" name="desc" placeholder="请输入个人介绍" class="form-control">
                        </div>
                        <div class="col-sm-4">
                            <span class="help-block m-b-none m-t-8"></span>
                        </div>
                    </div>
                    <div class="hr-line-dashed"></div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label m-t-8">工作邮箱</label>

                        <div class="col-sm-6">
                            <input type="text" value="{{ data.email or '' }}" name="email" placeholder="请输入工作邮箱" class="form-control">
                        </div>
                        <div class="col-sm-4">
                            <span class="help-block m-b-none m-t-8"></span>
                        </div>
                    </div>
                    <div class="hr-line-dashed"></div>

                    <div id="register-movieman" style="display: none;">
                        <br>
                        <div class="row">
                            <div class="col-sm-12 m-b-xs">
                                <div data-toggle="buttons" class="btn-group">
                                    <label class="btn btn-sm btn-white check-type active" id="hangye-auth-btn">
                                        <input type="radio" name="options">行业认证</label>
                                    <label class="btn btn-sm btn-white check-type" id="zuopin-auth-btn">
                                        <input type="radio" name="options">作品认证</label>

                                    <span id="auth-tips" style="margin-top: 6px; display: none;line-height: 30px;"> （最少填写一部作品，最多三部。）</span>
                                </div>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="hangye-auth">
                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">公司简介</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.shortname or '' }}" name="shortname" placeholder="请输入公司简介" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">公司全称</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.company or '' }}" name="company" placeholder="请输入公司全称" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">工作职务</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.role or '' }}" name="role" placeholder="请输入工作职务" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                        </div>

                        <div class="zuopin-auth" style="display: none;">

                            <div class="form-group">
                                <label class="col-sm-12 control-label m-t-8">影视作品：</label>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">作品名称</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.workname1 or '' }}" name="workname1" placeholder="请输入作品名称" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">担任角色</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.workrole1 or '' }}" name="workrole1" placeholder="请输入担任角色" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group">
                                <label class="col-sm-12 control-label m-t-8">戏剧作品：</label>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">作品名称</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.workname2 or '' }}" name="workname2" placeholder="请输入作品名称" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">担任角色</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.workrole2 or '' }}" name="workrole2" placeholder="请输入担任角色" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>

                            <div class="form-group">
                                <label class="col-sm-12 control-label m-t-8">文学作品：</label>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">作品名称</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.workname3 or '' }}" name="workname3" placeholder="请输入作品名称" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label m-t-8">发行方</label>

                                <div class="col-sm-6">
                                    <input type="text" value="{{ data.workrole3 or '' }}" name="workrole3" placeholder="请输入发行方" class="form-control">
                                </div>
                                <div class="col-sm-4">
                                    <span class="help-block m-b-none m-t-8"></span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 20px">
                        <br>
                        <input type="button" id="save-draft-btn" class="btn btn-primary btn-warning" value="保存草稿">
                        &nbsp;&nbsp;
                        <input type="button" id="open-auth-btn" class="btn btn-primary" value="开通权限">
                        &nbsp;&nbsp
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
{% endblock %}

{% block afterfoot %}

<script>
    $('#hangye-auth-btn').on('click', function() {
        $('.hangye-auth').show();
        $('.zuopin-auth').hide();
        $('#auth-tips').hide();
    });

    $('#zuopin-auth-btn').on('click', function() {
        $('.hangye-auth').hide();
        $('.zuopin-auth').show();
        $('#auth-tips').show();
    });

    $('#author-register-btn').on('click', function() {
        $('#register-movieman').hide();
    });

    $('#movieman-register-btn').on('click', function() {
        $('#register-movieman').show();
    });

    $('#save-draft-btn').click(function() {
        var data = getData();
        data.storedIp = '{{ param.storedIp }}';

        $.ajax({
            type: "post",
            url: "{{ param.apiHost }}/api/tools/saveDraft?token={{ param.token }}",
            data: data,
            dataType: "json",
            success: function(data) {
                if (data.code && data.code != 0) {
                    alert(data.msg || '保存失败！');
                } else {
                    alert('保存草稿成功！');
                }
            },
            error: function() {
                alert('保存失败！');
            }
        });

    });

    $('#open-auth-btn').click(function() {
        var data = getData();
        data.storedIp = '{{ param.storedIp }}';

        $.ajax({
            type: "post",
            url: "{{ param.apiHost }}/api/tools/openRight?token={{ param.token }}",
            data: data,
            dataType: "json",
            success: function(data) {
                if (data.code && data.code != 0) {
                    alert(data.msg || '保存失败！');
                } else {
                    alert('录入成功！');
                }
            },
            error: function() {
                alert('保存失败！');
            }
        });

    });

    function getData() {
        var fields = ["username", "desc", "email", "mobilePhoneNumber", "company", "role", "shortname", "workname1", "workrole1", "workname2", "workrole2", "workname3", "workrole3"];

        var key, item, data = {};

        for (key in fields) {
            item = fields[key];
            data[item] = $('input[name=' + item + ']').val();
        }

        return data;
    }


</script>

{% if data.shortname or data.company or data.role %}
<script>
    $('#movieman-register-btn').trigger('click');
</script>
{% endif %}

{% if data.workname1 or data.workname2 or data.workname3 %}
<script>
    $('#zuopin-auth-btn').trigger('click');
</script>
{% endif %}

{% endblock %}
